<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ include file="/common/common.jsp" %>
<%@ page import="java.net.DatagramSocket"%>
<%@ page import="java.net.DatagramPacket"%>
<%@ page import="java.net.InetAddress"%>
<%@ page import="java.net.SocketTimeoutException"%>
<%
	if(!Site.isPmss(out,"mon_list","")) return;

	DatagramSocket ds = null;

	try {
		// get parameter
		String system_ip = CommonUtil.getParameter("system_ip");
		String s_local_no = CommonUtil.getParameter("local_no");

		// 파라미터 체크
		if(!CommonUtil.hasText(system_ip)) {
			out.print(CommonUtil.getErrorMsg("NO_PARAM"));
			return;
		}

		// UDP 통신 수신 전문
		ds = new DatagramSocket();

		// send data 설정
		InetAddress address = InetAddress.getByName(system_ip);
		int port = 9998;
		String header = "MON000000X";
		//String header = "NON";
		byte[] buf = header.getBytes();

		// send
		DatagramPacket packet = new DatagramPacket(buf, buf.length, address, port);
		ds.send(packet);
		// timeout
		ds.setSoTimeout(2000);

		// receive
		buf = new byte[40000];
		packet = new DatagramPacket(buf, buf.length);
		String recv = "";
/*
		while(true) {
			try {
				ds.receive(packet);
				recv = new String(packet.getData(), "EUC-KR").trim();
				break;
			} catch (SocketTimeoutException se) {
				out.print("소켓 데이터 수신에 실패했습니다.");
				ds.close();
				throw new Exception(se);
			}
		}*/

		// receive data
		//logger.debug("receive data : " + recv);

		// example data
		//String recv = "MON112333X02C 107372  43732  63640D1793032 965021 82801109000125000700 701 E17001	   박현주			  1101	2112130025442468   00225000700 701 E17004	   이우리			  1102	211214101086603029 0031			E								1103	1				  0041			E								1104	1				  00515000700 701 E17003	   김형이			  1105	1111601			0061			E								1106	1				  00712000300 301 E12001	   김봄시내			1201	1094419			0082200021002101E12012	   김래희			  1202	211225901031016884 00912000300 301 E12008	   장인애			  1203	1112323			01022000300 301 E12009	   김효정			  1204	211232201088541444 01112000300 301 E12013	   채송아			  1205	1175951			0121			E								1206	1				  0131			E12026						   1207	1				  0141			E								1208	1				  0151			E								1209	1				  01612000300 301 E12003	   박소윤			  1210	1170034			01722000300 301 E12014	   신선화			  1211	211225101064736435 01812000300 301 E12016	   임태미			  1212	1175906			01912000300 301 E12025	   정수강			  1213	1125457			0201			E								1214	1				  02112000300 301 E12017	   임자영			  1109	1210147			0221			E								1110	1				  0231100010001002E11011	   정가영			  1111	1111058			0241100010001001E11012	   이인애			  1112	1105759			0251100010001002E11013	   우혜리			  1113	1112041			02613000400 401 E13001	   정지야			  1301	1111949			02723000400 401 E13003	   변명화			  1302	211225001099179793 02813000400 401 E13008	   한향숙			  1303	1111925			0291			E								1304	1				  0301			E								1305	1				  03113000400 401 E13007	   김혜숙			  1306	1112037			03212000300 301 E12019	   최은영			  1221	1210139			0331			E								1107	1				  03412000300 301 E12002	   이종희			  1108	1205854			0351100010001001E11014	   어인영			  1114	1102407			0361100010001001E11015	   홍지윤			  1115	1111201			0371			E								1116	1				  0381			E								1117	1				  0391			E								1118	1				  04014000500 506 E16012	   김동규			  1601	1191840			04114000500 506 E16020	   김용호			  1602	1210148			04214000500 506 E16030	   이인규			  1603	1205904			04314000500 502 E16074	   최수희			  1604	1112027			04414000500 502 E16050	   서희경			  1605	1144441			04514000500 502 E16056	   정솔이			  1606	1112313			04624000500 502 E16055	   김유진			  1607	21122140328308203  0471400041004101E16081	   김미경			  1608	1180444			04814000500 502 E16090	   고아름			  1609	1222534			0491400041004101E16040	   안소연2			 1610	1165850			0501400041004101E16037	   장기원			  1611	1111013			0511			E								1612	1				  05224000500 502 E16051	   한이임철			1613	211195201028995118 0531400041004101E16064	   장혜원			  1614	1210201			05414000500 502 E16083	   이명화			  1615	1110524			05514000500 502 E16042	   채소망			  1616	1111549			05614000500 502 E16048	   김효진			  1617	1111757			05714000500 505 E16058	   이수연			  1618	1090441			05814000500 501 E16047	   최성룡			  1619	1095137			05914000500 505 E16072	   오은경			  1620	1092033			06014000500 502 E16043	   장혜원			  1621	1090558			06114000500 501 E16049	   이형정			  1622	1145238			06214000500 502 E16066	   장휘현			  1623	1172506			06314000500 502 E16042	   채소망			  1624	1				  06414000500 505 E16071	   이준상			  1625	1090046			06514000500 506 E16012	   김동규			  1626	1095901			0661400041004101E16039	   박선라2			 1627	1090531			0671400041004101E16034	   이성호			  1628	1085255			06814000500 502 E16076	   정유정			  1629	1154804			06914000500 506 E16077	   황은지			  1630	1173220			07014000500 502 E16078	   이성원			  1631	1155059			07114000500 507 E14007	   홍승연			  1632	1102810			0721			E								1633	1				  07314000500 506 E16096	   이준일			  1634	1112214			07414000500 506 E16028	   이대경			  1635	1180556			07524000500 506 E16020	   김용호			  1636	211231390319671591 07614000500 506 E16030	   이인규			  1637	1085406			07714000500 506 E16015	   김지현			  1638	1210335			07814000500 506 E16099	   이상현			  1639	1090743			0791			E								1640	1				  08014000500 506 E16024	   김문수			  1641	1181747			08114000500 506 E16023	   임상우			  1642	1090536			08214000500 506 E16021	   이주창			  1643	1084452			08314000500 506 E16025	   고대훈			  1644	1085248			08414000500 501 E16061	   한경화			  1645	1094029			08514000500 502 E16079	   장경아			  1646	1150158			0861			E								1215	1				  0871			E								1216	1				  08814000500 506 E16060	   이지현			  1647	1173201			0891400041004101E16038	   박미선			  1648	1112250			0901			E										1";
		//recv = "MON000034X02C  52424   6098  46326D 947777 279441 66833620000111000500 510 E56006       김화영              1501    1161518            00211000500 503 E56043       정장미              1502    1                  00311000500 503 E56034       최종선              1503    1175448            00411000500 503 E56049       배은영              1504    1185439            00511000500 503 E56023       양주현              1505    1195659            00611000500 503 E56035       정현옥              1506    1164531            00711000500 503 E56041       유도은              1507    1170057            00811000500 503 E56009       신경신              1508    1175502            0091            E                                1509    1                  01011000500 503 E56085       연은주              1510    1180620            01111000500 502 E56079       이정미              1511    1210004            01211000500 502 E56063       오해정              1512    1205907            0131            E                                1513    1                  01411000500 510 E56002       송혜정              1514    1114313            01511000500 502 E56029       임수진              1515    1160924            01611000500 510 E56010       김대현              1516    1210107            01711000500 502 E56066       강금섬              1517    1184119            01811000500 502 E56030       김지원              1518    1210653            01911000500 502 E56062       주귀선              1519    1175842            02011000500 502 E56084       한경미              1520    1191413            0211            E                                1521    1                  02211000500 501 E56019       오은경              1522    1212403            02311000500 501 E56073       한현주              1523    1175813            02411000500 501 E56031       이영진              1524    1204516            02511000500 501 E56008       오경미              1525    1125535            02611000500 501 E56021       엄근홍              1526    1205915            02711000500 501 E56011       양수미              1527    1131015            02811000500 501 E56071       배영임              1528    1191007            02911000500 504 E56056       장선주              1529    1170605            03011000500 504 E56017       이현주              1530    1175859            0311            E                                1531    1                  03211000500 504 E56086       조현진              1532    1175855            03311000500 504 E56033       임헌미              1533    1172547            03411000500 504 E56033       임헌미              1534    1175701            03511000500 504 E56086       조현진              1535    1181703            03611000500 504 E56081       윤병희              1536    1180122            03711000500 504 E56044       변영혁              1537    1124729            03811000500 501 E56038       이은영              1538    1175247            03911000500 504 E56058       김민정              1539    1173806            04011000500 504 E56068       하민우              1540    1181905            04111000500 504 E56012       여운진              1541    1175359            04211000500 502 E56024       이희정              1542    1                  04311000500 506 E56054       김명희              1543    1165815            04411000500 501 E56022       양은주              1544    1175815            0451            E                                1545    1                  0461            E                                1546    1                  0471            E                                1547    1                  04813000230 232 E58118       안은화              1098    1                  04913000210 212 E58007       민선영              1099    1                  05011000500 510 E56004       조용옥              1550    1101021            0511            E                                1551    1                  0521            E                                1552    1                  05311000500 501 E56005       김수연2             1553    1                  05411000500 506 E56059       이정미B             1554    1182905            05513000210 212 E58060       한은미              1100    1                  05613000210 212 E58013       김성자              1101    1                  05713000210 211 E58065       지안                1102    1181231            05813000210 211 E58034       한겨레              1103    1                  05913000210 211 E58049       이영서              1104    1                  06013000210 212 E58074       전정희              1105    1225606            06113000210 211 E58064       한진아              1106    1175256            06213000210 212 E58101       김온주              1107    1210546            0631            E                                1108    1                  06413000210 211 E58061       박세원              1109    1170645            06513000210 211 E58028       이솔                1110    1175449            06613000220 224 E58035       정해옥              1111    1164113            0671            E                                1112    1                  06813000210 211 E58059       최성이              1113    1182001            06913000210 211 E58005       김은혜              1114    1                  07013000210 211 E58016       양노경              1115    1                  07113000210 212 E58041       원선정              1116    1230147            07213000210 211 E58050       서은옥              1117    1                  07313000210 211 E58037       임미경              1118    1133411            0741            E                                1119    1183425            07513000210 211 E58087       박진현              1121    1180034            07613000210 211 E58071       백나윤              1123    1175231            07713000210 211 E58009       김명아              1125    1175621            07813000210 211 E58110       박진현2             1132    1165217            07913000210 211 E58053       이슬기              1133    1214436            08013000210 211 E58059       최성이              1134    1183152            08113000210 212 E58007       민선영              1135    1223259            08213000210 211 E58066       김유림              1136    1173125            0831            E                                1137    1                  08413000210 211 E58112       김서영              1138    1190518            08513000210 211 E58031       신화경              1139    1182716            08613000210 211 E58017       김혜미              1140    1165007            08713000230 232 E58047       윤경                1141    1112255            08813000220 222 E58014       정지원              1142    1190109            08913000210 211 E58076       김주현              1143    1125323            09013000210 211 E58076       김주현              1144    1122910            09113000210 211 E58092       김은영              1145    1                  09213000210 212 E58032       박연화              1146    1224928            0931            E                                1148    1                  09413000210 211 E58008       최수경              1150    1174540            09513000230 232 E58027       유수현              1151    1220149            09613000220 224 E58035       정해옥              1152    1                  09713000220 224 E58056       김해란              1153    1163059            09813000220 224 E58072       심송화              1154    1155759            09913000220 224 E58102       이화                1155    1184951            1001            E                                1156    1                  10113000220 228 E58077       지서현              1157    1185544            10213000220 224 E58033       강해빈              1158    1                  10313000220 224 E58045       장미화              1159    1103254            10413000220 224 E58108       장여분              1160    1185119            10513000220 224 E58088       이용                1167    1190124            10613000220 224 E58003       김은영2             1168    1190319            10713000220 224 E58018       이영매              1169    1                  10813000220 224 E58089       최송연              1170    1190311            10913000220 224 E58045       장미화              1171    1190126            11013000220 224 E58023       김연                1172    1185827            11113000220 224 E58105       강매화              1173    1185645            11213000220 224 E58086       최지영              1175    1185855            11313000220 224 E58036       권경애              1176    1190254            11413000220 224 E58117       이광호              1177    1                  1151            E                                1178    1                  11613000230 232 E58047       윤경                1179    1185120            11713000220 224 E58098       박정연              1180    1185517            11813000220 224 E58039       윤선녀              1181    1184214            1191            E                                1182    1                  12012000200 201 E55001       황소희              1183    1194839            12112000200 202 E55041       김소희              1184    1195721            12212000200 201 E55011       김하나              1185    1194737            12312000200 201 E55043       최고은              1186    1182953            12412000200 201 E55006       이은정              1187    1175534            12512000200 202 E55002       박지영              1188    1183026            12612000200 201 E55004       김미균              1189    1195839            12712000200 202 E55029       구미선              1190    1182826            12812000200 202 E55038       심윤경              1191    1175656            12912000200 201 E55028       오현정              1192    1                  1301            E                                1193    1163347            13112000200 207 E58106       이향실              1194    1184513            13212000200 204 E55012       이희량              1195    1175649            13312000200 207 E58103       임지연              1196    1184650            13412000200 202 E55015       한미선              1197    1194757            13512000200 207 E55008       한소현              1198    1185745            13612000200 201 E55005       허라경              1199    1                  13712000200 207 E55007       전명설              1200    1                  13813000230 232 E58021       강혜미              1201    1170608            1391            E                                1202    1165705            14012000200 204 E55039       안종화              1203    1175731            14112000200 204 E55042       이민정              1204    1180231            14212000200 204 E55053       최지현              1205    1175020            14312000200 204 E55048       최영애              1206    1173702            14412000200 204 E55054       박인아              1207    1195413            1451500051005110E1373                            1373    1                  1461500051005110E1374                            1374    1                  1471600061006110E1381                            1381    1183206            1481600061006110E1382                            1382    1                  1491700071007110E1393                            1393    1200111            1501700071007110E1394                            1394    1133412            1511700071007110E1395                            1395    1171255            1521700071007110E1396                            1396    1185844            15311000500 506 E56047       이갑순              1561    1150212            15411000500 503 E56061       오은진              1562    1205439            15511000500 503 E56055       변희경              1563    1175850            15611000500 502 E56015       장봄                1564    1                  15711000500 502 E56045       이경춘              1565    1185751            15811000500 501 E56028       이현실              1548    1190009            15911000500 501 E56022       양은주              1549    1                  16013000210 216 E58051       이지혜              1208    1                  1611700071007110E1390                            1390    1                  1621700071007110E1391                            1391    1115834            1631700071007110E1392                            1392    1115621            16413000210 211 E58063       한승훈              1212    1100548            16513000210 211 E58026       이은철              1213    1                  1661700071007110E1397                            1397    1202525            16713000210 211 E58052       김선옥              1215    1143355            16813000210 211 E58020       한슬기              1216    1121224            16913000210 211 E58115       박표진              1217    1143331            17013000210 211 E58054       명미애              1218    1113721            17113000210 211 E55050       성혜진              1219    1145740            1721            E                                1220    1                  17313000210 211 E58059       최성이              1221    1222910            17413000210 211 E58040       최지예              1222    1185941            17513000210 211 E58038       김은희              1223    1141113            17613000220 223 E58085       쯔지야마아야까      1224    1185415            17713000220 224 E58002       김춘화              1225    1185227            1781700071007110E1398                            1398    1                  17913000220 224 E58048       서신                1227    1185630            18013000220 224 E58075       최한옥              1228    1184716            1811            E                                        1                  18213000220 224 E58029       김은숙              1230    1                  18313000220 224 E58010       성향옥              1231    1185617            1841700071007110E1399                            1399    1172701            18513000210 211 E58084       김현수              1233    1184117            1861            E                                        1                  18713000220 224 E58116       김매                1235    1190029            18813000210 216 E58024       이경애              1236    1163840            18913000210 211 E58025       이태희              1237    1184305            1901            E                                1238    1                  19112000200 204 E58022       최미영              1239    1174109            1921            E                                1240    1                  1931            E                                1241    1                  1941400041004110E1361                            1361    1110422            1951400041004110E1362                            1362    1                  1961400041004110E1363                            1363    1                  1971400041004110E1364                            1364    1                  1981400041004110E1365                            1365    1                  1991500051005110E1371                            1371    1                  2001500051005110E1372                            1372    1142604";
		recv = "MON000004X02C  52424   6098  46326D 947777 279441 66833620000111000500 510 E56006       김화영              1501    1161518            00211000500 503 E56043       정장미              1502    1                  00311000500 503 E56034       최종선              1503    1175448            00411000500 503 E56049       배은영              1504    1185439            00511000500 503 E56023       양주현              1505    1195659            00611000500 503 E56035       정현옥              1506    1164531            00711000500 503 E56041       유도은              1507    1170057            00811000500 503 E56009       신경신              1508    1175502            0091            E                                1509    1                  01011000500 503 E56085       연은주              1510    1180620            01111000500 502 E56079       이정미              1511    1210004            01211000500 502 E56063       오해정              1512    1205907            0131            E                                1513    1                  01411000500 510 E56002       송혜정              1514    1114313            01511000500 502 E56029       임수진              1515    1160924            01611000500 510 E56010       김대현              1516    1210107            01711000500 502 E56066       강금섬              1517    1184119            01811000500 502 E56030       김지원              1518    1210653            01911000500 502 E56062       주귀선              1519    1175842            02011000500 502 E56084       한경미              1520    1191413            0211            E                                1521    1                  02211000500 501 E56019       오은경              1522    1212403            02311000500 501 E56073       한현주              1523    1175813            02411000500 501 E56031       이영진              1524    1204516            02511000500 501 E56008       오경미              1525    1125535            02611000500 501 E56021       엄근홍              1526    1205915            02711000500 501 E56011       양수미              1527    1131015            02811000500 501 E56071       배영임              1528    1191007            02911000500 504 E56056       장선주              1529    1170605            03011000500 504 E56017       이현주              1530    1175859            0311            E                                1531    1                  03211000500 504 E56086       조현진              1532    1175855            03311000500 504 E56033       임헌미              1533    1172547            03411000500 504 E56033       임헌미              1534    1175701            03511000500 504 E56086       조현진              1535    1181703            03611000500 504 E56081       윤병희              1536    1180122            03711000500 504 E56044       변영혁              1537    1124729            03811000500 501 E56038       이은영              1538    1175247            03911000500 504 E56058       김민정              1539    1173806            04011000500 504 E56068       하민우              1540    1181905            04111000500 504 E56012       여운진              1541    1175359            04211000500 502 E56024       이희정              1542    1                  04311000500 506 E56054       김명희              1543    1165815            04411000500 501 E56022       양은주              1544    1175815            0451            E                                1545    1                  0461            E                                1546    1                  0471            E                                1547    1                  04813000230 232 E58118       안은화              1098    1                  04913000210 212 E58007       민선영              1099    1                  05011000500 510 E56004       조용옥              1550    1101021            0511            E                                1551    1                  0521            E                                1552    1                  05311000500 501 E56005       김수연2             1553    1                  05411000500 506 E56059       이정미B             1554    1182905            05513000210 212 E58060       한은미              1100    1                  05613000210 212 E58013       김성자              1101    1                  05713000210 211 E58065       지안                1102    1181231            05813000210 211 E58034       한겨레              1103    1                  05913000210 211 E58049       이영서              1104    1                  06013000210 212 E58074       전정희              1105    1225606            06113000210 211 E58064       한진아              1106    1175256            06213000210 212 E58101       김온주              1107    1210546            0631            E                                1108    1                  06413000210 211 E58061       박세원              1109    1170645            06513000210 211 E58028       이솔                1110    1175449            06613000220 224 E58035       정해옥              1111    1164113            0671            E                                1112    1                  06813000210 211 E58059       최성이              1113    1182001            06913000210 211 E58005       김은혜              1114    1                  07013000210 211 E58016       양노경              1115    1                  07113000210 212 E58041       원선정              1116    1230147            07213000210 211 E58050       서은옥              1117    1                  07313000210 211 E58037       임미경              1118    1133411            0741            E                                1119    1183425            07513000210 211 E58087       박진현              1121    1180034            07613000210 211 E58071       백나윤              1123    1175231            07713000210 211 E58009       김명아              1125    1175621            07813000210 211 E58110       박진현2             1132    1165217            07913000210 211 E58053       이슬기              1133    1214436            08013000210 211 E58059       최성이              1134    1183152            08113000210 212 E58007       민선영              1135    1223259            08213000210 211 E58066       김유림              1136    1173125            0831            E                                1137    1                  08413000210 211 E58112       김서영              1138    1190518            08513000210 211 E58031       신화경              1139    1182716            08613000210 211 E58017       김혜미              1140    1165007            08713000230 232 E58047       윤경                1141    1112255            08813000220 222 E58014       정지원              1142    1190109            08913000210 211 E58076       김주현              1143    1125323            09013000210 211 E58076       김주현              1144    1122910            09113000210 211 E58092       김은영              1145    1                  09213000210 212 E58032       박연화              1146    1224928            0931            E                                1148    1                  09413000210 211 E58008       최수경              1150    1174540            09513000230 232 E58027       유수현              1151    1220149            09613000220 224 E58035       정해옥              1152    1                  09713000220 224 E58056       김해란              1153    1163059            09813000220 224 E58072       심송화              1154    1155759            09913000220 224 E58102       이화                1155    1184951            1001            E                                1156    1                  10113000220 228 E58077       지서현              1157    1185544            10213000220 224 E58033       강해빈              1158    1                  10313000220 224 E58045       장미화              1159    1103254            10413000220 224 E58108       장여분              1160    1185119            10513000220 224 E58088       이용                1167    1190124            10613000220 224 E58003       김은영2             1168    1190319            10713000220 224 E58018       이영매              1169    1                  10813000220 224 E58089       최송연              1170    1190311            10913000220 224 E58045       장미화              1171    1190126            11013000220 224 E58023       김연                1172    1185827            11113000220 224 E58105       강매화              1173    1185645            11213000220 224 E58086       최지영              1175    1185855            11313000220 224 E58036       권경애              1176    1190254            11413000220 224 E58117       이광호              1177    1                  1151            E                                1178    1                  11613000230 232 E58047       윤경                1179    1185120            11713000220 224 E58098       박정연              1180    1185517            11813000220 224 E58039       윤선녀              1181    1184214            1191            E                                1182    1                  12012000200 201 E55001       황소희              1183    1194839            12112000200 202 E55041       김소희              1184    1195721            12212000200 201 E55011       김하나              1185    1194737            12312000200 201 E55043       최고은              1186    1182953            12412000200 201 E55006       이은정              1187    1175534            12512000200 202 E55002       박지영              1188    1183026            12612000200 201 E55004       김미균              1189    1195839            12712000200 202 E55029       구미선              1190    1182826            12812000200 202 E55038       심윤경              1191    1175656            12912000200 201 E55028       오현정              1192    1                  1301            E                                1193    1163347            13112000200 207 E58106       이향실              1194    1184513            13212000200 204 E55012       이희량              1195    1175649            13312000200 207 E58103       임지연              1196    1184650            13412000200 202 E55015       한미선              1197    1194757            13512000200 207 E55008       한소현              1198    1185745            13612000200 201 E55005       허라경              1199    1                  13712000200 207 E55007       전명설              1200    1                  13813000230 232 E58021       강혜미              1201    1170608            1391            E                                1202    1165705            14012000200 204 E55039       안종화              1203    1175731            14112000200 204 E55042       이민정              1204    1180231            14212000200 204 E55053       최지현              1205    1175020            14312000200 204 E55048       최영애              1206    1173702            14412000200 204 E55054       박인아              1207    1195413            1451500051005110E1373                            1373    1                  1461500051005110E1374                            1374    1                  1471600061006110E1381                            1381    1183206            1481600061006110E1382                            1382    1                  1491700071007110E1393                            1393    1200111            1501700071007110E1394                            1394    1133412            1511700071007110E1395                            1395    1171255            1521700071007110E1396                            1396    1185844            15311000500 506 E56047       이갑순              1561    1150212            15411000500 503 E56061       오은진              1562    1205439            15511000500 503 E56055       변희경              1563    1175850            15611000500 502 E56015       장봄                1564    1                  15711000500 502 E56045       이경춘              1565    1185751            15811000500 501 E56028       이현실              1548    1190009            15911000500 501 E56022       양은주              1549    1                  16013000210 216 E58051       이지혜              1208    1                  1611700071007110E1390                            1390    1                  1621700071007110E1391                            1391    1115834            1631700071007110E1392                            1392    1115621            16413000210 211 E58063       한승훈              1212    1100548            16513000210 211 E58026       이은철              1213    1                  1661700071007110E1397                            1397    1202525            16713000210 211 E58052       김선옥              1215    1143355            16813000210 211 E58020       한슬기              1216    1121224            16913000210 211 E58115       박표진              1217    1143331            17013000210 211 E58054       명미애              1218    1113721            17113000210 211 E55050       성혜진              1219    1145740            1721            E                                1220    1                  17313000210 211 E58059       최성이              1221    1222910            17413000210 211 E58040       최지예              1222    1185941            17513000210 211 E58038       김은희              1223    1141113            17613000220 223 E58085       쯔지야마아야까      1224    1185415            17713000220 224 E58002       김춘화              1225    1185227            1781700071007110E1398                            1398    1                  17913000220 224 E58048       서신                1227    1185630            18013000220 224 E58075       최한옥              1228    1184716            1811            E                                        1                  18213000220 224 E58029       김은숙              1230    1                  18313000220 224 E58010       성향옥              1231    1185617            1841700071007110E1399                            1399    1172701            18513000210 211 E58084       김현수              1233    1184117            1861            E                                        1                  18713000220 224 E58116       김매                1235    1190029            18813000210 216 E58024       이경애              1236    1163840            18913000210 211 E58025       이태희              1237    1184305            1901            E                                1238    1                  19112000200 204 E58022       최미영              1239    1174109            1921            E                                1240    1                  1931            E                                1241    1                  1941400041004110E1361                            1361    1110422            1951400041004110E1362                            1362    1                  1961400041004110E1363                            1363    1                  1971400041004110E1364                            1364    1                  1981400041004110E1365                            1365    1                  1991500051005110E1371                            1371    1                  2001500051005110E1372                            1372    1142604";
		
		//logger.debug("receive data : " + recv);
		
		int hdd_cnt = 0;
		int ch_cnt = 0;
		int p = 0;
		String hdd_data = "";
		String ch_data = "";

		// 헤더 정보 삭제 (MON163335X)
		recv = recv.substring(10);

		// 하드 수량
		hdd_cnt = Integer.parseInt(recv.substring(0,2));

		// 하드 데이터
		hdd_data = recv.substring(2, (hdd_cnt*22)+2);

		// 하드 데이터 삭제 (D 718278 176349 541929E 165277 158941   6336)
		recv = recv.substring((hdd_cnt*22)+2);

		// 채널 수
		ch_cnt = Integer.parseInt(recv.substring(0,3));

		// 채널 데이터 (채널 데이터 삭제, 061)
		ch_data = recv.substring(3);
		
		/*
		logger.debug("헤더, 하드 데이터 삭제 후 data : " + recv);
		logger.debug("hdd_cnt : " + hdd_cnt);
		logger.debug("hdd_data : " + hdd_data);
		logger.debug("ch_cnt : " + ch_cnt);
		logger.debug("ch_data : " + ch_data);
		*/
%>
	<!--HDD 데이터 table-->
	<div class="tableSize2">
		<table class="table top-line1 table-bordered">
			<thead>
				<tr>
					<th style="width:10%;">디스크 명</th>
					<th style="width:25%;">사용량 / 총 용량</th>
					<th style="width:15%;">사용률</th>
					<th style="width:10%;">디스크 명</th>
					<th style="width:25%;">사용량 / 총 용량</th>
					<th style="width:15%;">사용률</th>
				</tr>
			</thead>
			<tbody>
<%
	if(hdd_cnt > 0) 
	{
		out.print("<tr>\n");
		String hdd_name = "";
		Float hdd_total = 0.0f;
		Float hdd_use = 0.0f;
		Float hdd_free = 0.0f;
		for(int i=0;i<hdd_cnt;i++) 
		{
			if(i!=0 && i%2==0) {
				out.print("</tr><tr class='odd'>");
			}

			hdd_name = hdd_data.substring(p+0, p+1);
			hdd_total = Float.parseFloat(hdd_data.substring(p+1, p+8).trim());
			hdd_free = Float.parseFloat(hdd_data.substring(p+8, p+15).trim());
			hdd_use = Float.parseFloat(hdd_data.substring(p+15, p+22).trim());

			out.print("<td>" + hdd_name + " Drive</td>");
			out.print("<td>" + Math.round(hdd_use/1024*100)/100.0 + "G / " + Math.round(hdd_total/1024*100)/100.0 + "G</td>");
			out.print("<td>" + Math.round(hdd_use/hdd_total*100*100)/100.0 + "%</td>");

			p+=22;
		}
		
		if(hdd_cnt%2==1) 
		{
			out.print("<td></td>");
			out.print("<td></td>");
			out.print("<td></td>");
		}
		out.print("</tr>\n");
	}
%>
			</tbody>
		</table>
	</div>
	<!--내선번호 영역 시작-->
	<div class="grey_back1">
<%
	/* 전문정보
		-----------------------------------------------------------------------------
		구분			자릿수	위치			값
		-----------------------------------------------------------------------------
		채널번호		3		0-2			001
		채널종류		1		3			2
		대분류		4		4-7			5000
		중분류		4		8-11		700\s
		소분류		4		12-15		701\s
		레벨			1		16			E
		아이디		12		17-28		17001\s\s\s\s\s\s\s
		상담원명		20		29-48		박현주\s\s\s\s\s\s\s\s\s\s\s\s\s\s (한글 2자리)
		내선번호		8		49-56		1101\s\s\s\s
		상태			1		57			2
		상태변경시간	6		58-63		112130
		고객전화번호	12		64-75		025442468\s\s\s
		-----------------------------------------------------------------------------
	*/
	if(ch_cnt>0) 
	{
		p = 0;
		int h_cnt = 0;
		// 채널 1개당 문자열 수
		int per_ch_cnt = 76;
		String ch_no = "";
		String user_name = "";
		String user_id = "";
		String local_no = "";
		String ch_status = "";
		String status_cls = "";
		
		String bpart_code = "";
		String mpart_code = "";

		for(int i=0;i<ch_cnt;i++) 
		{
			ch_no = ch_data.substring(p+0,p+3).trim();
			// 상담원명 중 한글 개수 카운트
			h_cnt = CommonUtil.getHangulCnt(ch_data.substring(p+29,p+49));
			user_id = ch_data.substring(p+17,p+29-h_cnt).trim();
			
			
			user_name = ch_data.substring(p+29,p+49-h_cnt).trim();
			//logger.info("h_cnt : "+h_cnt);
			//logger.info("user_name : "+user_name);
			local_no = ch_data.substring(p+49-h_cnt,p+57-h_cnt).trim();
			ch_status = ch_data.substring(p+57-h_cnt,p+58-h_cnt).trim();

			// 상태별 색상 설정
			if("1".equals(ch_status)) {										// 대기
				status_cls = "1";
			} else if("2".equals(ch_status) || "3".equals(ch_status)) {		// 녹취 상태
				status_cls = "2";
			} else {														// 녹취 불량
				status_cls = "3";
			}

			bpart_code = ch_data.substring(p+4,p+8).trim();
			mpart_code = ch_data.substring(p+8,p+12).trim();
			
			
			

			if("".equals(s_local_no) || (!"".equals(s_local_no) && local_no.equals(s_local_no)))
			{
				out.print("<div class=\"ext_frame\">\n");
				out.print("	<div class=\"ext_number ext_bg0" + status_cls + "\" style=\"cursor: pointer;\" onclick=\"playRlisten('" + status_cls + "','" + ch_no + "','" + local_no + "','01','" + user_id + "','" + user_name + "')\">" + ch_no + "</div>\n");
				out.print("	<div class=\"ext_name\">\n");
				out.print("		<span>" + user_name + "</span>\n");
				out.print("		<span style=\"font-size:12px;color:#666;\">" + local_no + "</span>\n");
				out.print("	</div>\n");
				out.print("</div>\n");
			}

			p+=per_ch_cnt-h_cnt;
		}
	}
%>
	</div>
	<!--HDD 데이터 table 끝-->
	<div class="grey_back2">
		<div class="colLeft"><span class="ext_squre01 colLeft"></span><span class="ext_text">대기상태</span></div>
		<div class="colLeft"><span class="ext_squre02 colLeft"></span><span class="ext_text">녹취상태</span></div>
		<div class="colLeft"><span class="ext_squre03 colLeft"></span><span class="ext_text">녹취불량</span></div>
	</div>
<%
	} catch(NullPointerException e) {
		logger.error(e.getMessage());
	} catch(Exception e) {
		logger.error(e.getMessage());
	} finally {
		// socket close
		if (ds != null) ds.close();
	}
%>